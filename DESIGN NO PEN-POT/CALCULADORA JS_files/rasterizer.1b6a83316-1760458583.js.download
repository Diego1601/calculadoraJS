(function(){
'use strict';var TMb=function(a){return PENPOT.bv(function(b){var c=new Image;PENPOT.Pt(c,"onload",function(){b.next(c);return b.complete()});PENPOT.Pt(c,"crossOrigin","anonymous");PENPOT.Pt(c,"onerror",function(d){return b.error(d)});PENPOT.Pt(c,"onabort",function(){return b.error(PENPOT.gh("operation aborted",PENPOT.kh.d_(PENPOT.u([new PENPOT.k(null,3,[PENPOT.mh,PENPOT.yv,PENPOT.gn,PENPOT.MVa,PENPOT.gq,"operation aborted"],null),null])),null))});PENPOT.Pt(c,"src",a);return function(){PENPOT.Pt(c,
"src","");PENPOT.Pt(c,"onload",null);PENPOT.Pt(c,"onerror",null);return PENPOT.Pt(c,"onabort",null)}})},UMb=function(a,b,c){var d=a/b;return a<b?new PENPOT.A(null,2,5,PENPOT.D,[c,1/d*c],null):new PENPOT.A(null,2,5,PENPOT.D,[c*d,c],null)},WMb=function(a){if(PENPOT.m(VMb.has(a))){var b=VMb.get(a);return PENPOT.dv(b.text())}return PENPOT.pv(function(c){return c==null?(0,PENPOT.Pv)(a):PENPOT.sv(function(d){return VMb.set(a,PENPOT.QVa(d,"text/plain"))},PENPOT.pv(PENPOT.PVa,(0,PENPOT.Pv)(PENPOT.Kj.b_(c))))},
PENPOT.rv(function(c){if(PENPOT.Jt("app.rasterizer",PENPOT.qk)){var d=function(){return new PENPOT.Sg(function(){return new PENPOT.A(null,1,5,PENPOT.D,[new PENPOT.A(null,2,5,PENPOT.D,[PENPOT.gq,"fetching data uri"],null)],null)})}(),e=PENPOT.Lt();PENPOT.Gt(function(){var f=PENPOT.Tb(d),h=PENPOT.Mf.a_(PENPOT.wA,f);f=PENPOT.mu.b_(PENPOT.kh.d_(PENPOT.u([null,null])));var l=new PENPOT.k(null,7,[PENPOT.xA,f,PENPOT.yA,e,PENPOT.zA,h,PENPOT.AA,PENPOT.In(),PENPOT.BA,new PENPOT.Sg(function(){return PENPOT.Kt(h)}),
PENPOT.CA,"app.rasterizer",PENPOT.DA,PENPOT.qk],null);f=function(){return c!=null?PENPOT.y.d_(l,PENPOT.lD,c,PENPOT.u([PENPOT.s5a,new PENPOT.Sg(function(){return c.stack})])):l}();return PENPOT.Vg.a_(PENPOT.EA,PENPOT.Je(f))})}return(0,PENPOT.Pv)(null)},PENPOT.Vv(new PENPOT.k(null,5,[PENPOT.Qv,a,PENPOT.Uv,PENPOT.bE,PENPOT.ml,PENPOT.uA,PENPOT.Yr,PENPOT.FWa,PENPOT.GWa,!0],null))))},XMb=function(a){var b=PENPOT.Iv(a,"href");return PENPOT.m(b)?PENPOT.Di(b,"data:")?(0,PENPOT.Pv)(a):PENPOT.nv(function(c){PENPOT.Mv(a,
"href",c);return a},WMb(b)):PENPOT.ev()},YMb=function(a,b){var c=a.documentElement;var d=a.createElementNS("http://www.w3.org/2000/svg","style");PENPOT.Jv(d,a.createTextNode(b));return PENPOT.Jv(c,d)},ZMb=function(a){return PENPOT.qv(function(b,c){var d=PENPOT.v(c,0,null);c=PENPOT.v(c,1,null);return PENPOT.Ii(b,d,c)},a,PENPOT.pv(function(b){return PENPOT.nv(function(c){return new PENPOT.A(null,2,5,PENPOT.D,[b,c],null)},WMb(b))},PENPOT.nv(PENPOT.Nc,PENPOT.dv(PENPOT.Eg(/url\((https?:\/\/[^)]+)\)/,a)))))},
$Mb=function(a){return PENPOT.tv(PENPOT.pv(function(b){var c=PENPOT.Iv(b,"style");return PENPOT.sv(function(d){return PENPOT.Mv(b,"style",d)},ZMb(c))},PENPOT.dv(PENPOT.nWa(a,"[style]"))))},aNb=function(a){return PENPOT.tv(PENPOT.pv(function(b){return PENPOT.sv(function(c){return PENPOT.pWa(b,c)},ZMb(PENPOT.oWa(b)))},PENPOT.dv(PENPOT.nWa(a,"style"))))},bNb=function(a,b){return PENPOT.gv(PENPOT.tv(PENPOT.pv(XMb,PENPOT.dv(PENPOT.nWa(a,"image")))),PENPOT.tv(PENPOT.sv(PENPOT.Ke(YMb,a),ZMb(b))),$Mb(a),
aNb(a),(0,PENPOT.Pv)(a))},cNb=function(a){return(new DOMParser).parseFromString(a,"image/svg+xml")},dNb=function(a){a=a.documentElement;return(new XMLSerializer).serializeToString(a)},eNb=function(a,b,c){a=cNb(a);return PENPOT.nv(dNb,PENPOT.nv(function(d){var e=d.documentElement;var f=d.documentElement;var h=PENPOT.Iv(f,"width");f=PENPOT.Iv(f,"height");PENPOT.uj(h,f)?(f=d.documentElement,h=PENPOT.Iv(f,"width"),f=PENPOT.Iv(f,"height"),h=UMb(PENPOT.sj(h,0),PENPOT.sj(f,0),c)):(h=PENPOT.Iv(d.documentElement,
"viewBox"),typeof h==="string"?(f=PENPOT.Ji(h,/\s+/),PENPOT.v(f,0,null),PENPOT.v(f,1,null),h=PENPOT.v(f,2,null),f=PENPOT.v(f,3,null),h=UMb(PENPOT.sj(h,0),PENPOT.sj(f,0),c)):h=null);f=h;h=PENPOT.v(f,0,null);f=PENPOT.v(f,1,null);PENPOT.Mv(e,"width",""+(h??""));PENPOT.Mv(e,"height",""+(f??""));return d},bNb(a,b)))},fNb=function(a){return PENPOT.bv(function(b){var c=PENPOT.jB.createElement("canvas");c.width=a.width;c.height=a.height;c.getContext("bitmaprenderer").transferFromImageBitmap(a);c.toBlob(function(d){b.next(d);
return b.complete()});return PENPOT.Je(null)})},gNb=function(a){var b=a.data,c=a.styles,d=PENPOT.dq.a_(a.width,300),e=PENPOT.dq.a_(a.quality,"medium");return PENPOT.pv(function(f){return PENPOT.sv(function(){return PENPOT.RVa(f)},PENPOT.pv(function(h){var l={resizeWidth:d,resizeQuality:e};var n=h.width;var t=h.height;if("OffscreenCanvas"in window)n=new OffscreenCanvas(n,t);else{var z=document.createElement("canvas");PENPOT.Pt(z,"width",n);PENPOT.Pt(z,"height",t);n=z}n.getContext("2d").drawImage(h,
0,0);return createImageBitmap(n,l)},TMb(f)))},PENPOT.nv(PENPOT.SVa,PENPOT.nv(function(f){return PENPOT.QVa(f,"image/svg+xml")},eNb(b,c,d))))},kNb=function(a){var b=a.data;if(PENPOT.Di(hNb,a.origin)){var c=b.id;a=b.payload;b=b.scope;if(a!=null&&PENPOT.r.a_(b,"penpot/rasterizer")){b=PENPOT.Ke(iNb,c);c=PENPOT.Ke(jNb,c);a:switch(PENPOT.dq.a_(a.result,"blob")){case "image-bitmap":a=gNb(a);break a;default:a=PENPOT.pv(fNb,gNb(a))}a=PENPOT.BVa(a,b,c)}else a=null;return a}return null},lNb=function(a,b,c){a=
{id:a,type:b,scope:"penpot/rasterizer",payload:c};return window===parent?null:c instanceof ImageBitmap?parent.postMessage(a,hNb,[c]):parent.postMessage(a,hNb)},iNb=function(a,b){return lNb(a,"success",b)},jNb=function(a,b){return lNb(a,"failure",PENPOT.jh(b))},nNb=function(){window.addEventListener("message",kNb);lNb(null,"ready",null);if(PENPOT.Jt("app.rasterizer",PENPOT.Hj)){var a=function(){return new PENPOT.Sg(function(){return new PENPOT.A(null,3,5,PENPOT.D,[new PENPOT.A(null,2,5,PENPOT.D,[PENPOT.gq,
"initialized"],null),new PENPOT.A(null,2,5,PENPOT.D,[PENPOT.vzb,""+(PENPOT.Ut??"")],null),new PENPOT.A(null,2,5,PENPOT.D,[mNb,""+(hNb??"")],null)],null)})}(),b=PENPOT.Lt();PENPOT.Gt(function(){var c=PENPOT.Tb(a),d=PENPOT.Mf.a_(PENPOT.wA,c);c=PENPOT.mu.b_(PENPOT.kh.d_(PENPOT.u([null,null])));c=new PENPOT.k(null,7,[PENPOT.xA,c,PENPOT.yA,b,PENPOT.zA,d,PENPOT.AA,PENPOT.In(),PENPOT.BA,new PENPOT.Sg(function(){return PENPOT.Kt(d)}),PENPOT.CA,"app.rasterizer",PENPOT.DA,PENPOT.Hj],null);return PENPOT.Vg.a_(PENPOT.EA,
PENPOT.Je(c))})}return null},mNb=new PENPOT.x(null,"parent-uri","parent-uri",-371819908);PENPOT.Ra("rasterizer");PENPOT.It.set("app.rasterizer",PENPOT.Ht(PENPOT.Hj));var VMb=new Map,hNb=""+(PENPOT.Ut??"");PENPOT.na("app.rasterizer.init",nNb);PENPOT.db();nNb();
}).call(this);
//# sourceMappingURL=rasterizer.1b6a83316-1760458583.js.map
